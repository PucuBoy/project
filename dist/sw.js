const CACHE_VERSION="v1";importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-sw.js"),self.addEventListener("install",(e=>{console.log("Service Worker installing."),e.waitUntil(caches.open("v1-offline-cache").then((e=>e.add("./offline.html"))))})),self.addEventListener("activate",(e=>{console.log("Service Worker activating."),e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>e.startsWith("v1")?null:caches.delete(e)))))))})),workbox.setConfig({debug:!1});const{strategies,routing,precaching,cacheableResponse,expiration}=workbox;routing.registerRoute((({url:e})=>"https://fonts.googleapis.com"===e.origin||"https://fonts.gstatic.com"===e.origin),new strategies.StaleWhileRevalidate({cacheName:"google-fonts"})),routing.registerRoute((({request:e})=>"image"===e.destination),new strategies.CacheFirst({cacheName:"images",plugins:[new cacheableResponse.CacheableResponsePlugin({statuses:[0,200]}),new expiration.ExpirationPlugin({maxEntries:60,maxAgeSeconds:2592e3})]})),routing.registerRoute((({url:e})=>"https://story-api.dicoding.dev"===e.origin),new strategies.StaleWhileRevalidate({cacheName:"api-cache",plugins:[new cacheableResponse.CacheableResponsePlugin({statuses:[0,200]})]}));const BASE_URL=self.location.pathname.replace("sw.js","");self.addEventListener("install",(e=>{console.log("Service Worker installing.");const t=`${BASE_URL}offline.html`;e.waitUntil(caches.open("v1-offline-cache").then((e=>e.add(t))))})),self.addEventListener("fetch",(e=>{"navigate"===e.request.mode&&e.respondWith(fetch(e.request).catch((()=>caches.match(`${BASE_URL}offline.html`))))})),self.addEventListener("push",(function(e){const t={body:e.data.text(),icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1}};e.waitUntil(Promise.all([self.registration.showNotification("Story Explorer",t),self.clients.matchAll().then((t=>{t.forEach((t=>{t.postMessage({type:"STORY_CREATED",payload:e.data.text()})}))}))]))}));