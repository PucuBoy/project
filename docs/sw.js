const CACHE_NAME="story-explorer-v1",assetsToCache=["/","/index.html","/offline.html","/manifest.json","/icons/icon-72x72.png","/icons/icon-144x144.png","/icons/icon-192x192.png","/icons/icon.png","/styles/pwa.css","/app.bundle.js","/scripts/utils/sw-register.js","/src/scripts/views/offline-view.js"];self.addEventListener("install",(e=>{self.skipWaiting(),e.waitUntil(caches.open(CACHE_NAME).then((e=>Promise.all(assetsToCache.map((s=>e.add(s).catch((e=>(console.warn("Failed to cache:",s),Promise.resolve())))))))))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e)))))))})),self.addEventListener("fetch",(e=>{e.request.url.includes("/ws")||e.respondWith(caches.match(e.request).then((s=>{if(s)return s;const t=e.request.clone();return fetch(t).then((s=>{if("opaque"===s.type||"GET"!==e.request.method)return s;if(!s||200!==s.status)return s;const t=s.clone();return caches.open(CACHE_NAME).then((s=>{s.put(e.request,t)})),s})).catch((()=>e.request.url.includes(".app.bundle.js")?new Response(null,{status:404}):"image"===e.request.destination?caches.match("/icons/icon.png"):"navigate"===e.request.mode?caches.match("/offline.html"):new Response(null,{status:404})))})))}));